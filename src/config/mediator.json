{
  "urn": "urn:uuid:7a38f734-0f7b-4f62-9b70-5a6b0d3b5a8e",
  "version": "0.1.0",
  "name": "Faru MNRT NBS Mediator",
  "description": "Daily pull of NBS data sources into MongoDB",
  "defaultChannelConfig": [],
  "endpoints": [
    {
      "name": "NBS Sync",
      "type": "http",
      "status": "enabled",
      "host": "localhost",
      "port": 8095,
      "path": "/nbs/sync",
      "primary": true
    },
    {
      "name": "NBS Snapshots",
      "type": "http",
      "status": "enabled",
      "host": "localhost",
      "port": 8095,
      "path": "/nbs/snapshots",
      "primary": true
    }
  ],
  "configDefs": [
    {
      "param": "enabled",
      "displayName": "Enabled",
      "description": "Enable mediator",
      "type": "bool"
    },
    {
      "param": "schedule",
      "displayName": "Schedule",
      "description": "Daily schedule settings",
      "type": "struct",
      "values": [],
      "template": [
        {
          "param": "dailyAt",
          "displayName": "Daily time (HH:mm)",
          "description": "Time to run daily job",
          "type": "string"
        },
        {
          "param": "runOnStartup",
          "displayName": "Run on startup",
          "description": "Run a sync when the mediator starts",
          "type": "bool"
        }
      ]
    },
    {
      "param": "request",
      "displayName": "Request Params",
      "description": "Query param names for date range",
      "type": "struct",
      "values": [],
      "template": [
        {
          "param": "startDateParam",
          "displayName": "Start date param",
          "description": "Query param name for start date",
          "type": "string"
        },
        {
          "param": "endDateParam",
          "displayName": "End date param",
          "description": "Query param name for end date",
          "type": "string"
        }
      ]
    },
    {
      "param": "storage",
      "displayName": "Storage",
      "description": "MongoDB storage settings",
      "type": "struct",
      "values": [],
      "template": [
        {
          "param": "mongoUrl",
          "displayName": "Mongo URL",
          "description": "MongoDB connection string",
          "type": "string"
        },
        {
          "param": "dbName",
          "displayName": "Database name (optional)",
          "description": "Overrides database name in connection string",
          "type": "string"
        },
        {
          "param": "collection",
          "displayName": "Snapshots collection",
          "description": "Collection to store snapshots",
          "type": "string"
        },
        {
          "param": "stateCollection",
          "displayName": "State collection",
          "description": "Collection to store sync state",
          "type": "string"
        }
      ]
    },
    {
      "param": "sources",
      "displayName": "API Sources",
      "description": "Configured API sources",
      "type": "struct",
      "values": [],
      "template": [
        {
          "param": "name",
          "displayName": "Name",
          "description": "Source name",
          "type": "string"
        },
        {
          "param": "url",
          "displayName": "URL",
          "description": "Endpoint URL",
          "type": "string"
        },
        {
          "param": "apiKey",
          "displayName": "API key",
          "description": "API key for the source",
          "type": "password"
        },
        {
          "param": "apiKeyHeader",
          "displayName": "API key header",
          "description": "Header name for the API key",
          "type": "string"
        },
        {
          "param": "tlsAllowInsecure",
          "displayName": "Allow insecure TLS",
          "description": "Disable TLS certificate verification for this source",
          "type": "bool"
        },
        {
          "param": "enabled",
          "displayName": "Enabled",
          "description": "Enable this source",
          "type": "bool"
        }
      ],
      "array": true
    }
  ],
  "config": {
    "enabled": true,
    "schedule": {
      "dailyAt": "01:00",
      "runOnStartup": true
    },
    "request": {
      "startDateParam": "startDate",
      "endDateParam": "endDate"
    },
    "storage": {
      "mongoUrl": "mongodb://localhost/faru-mnrt",
      "dbName": "",
      "collection": "nbs_api_snapshots",
      "stateCollection": "nbs_sync_state"
    },
    "sources": [
      {
        "name": "NCAA",
        "url": "https://safariportal2.ncaa.go.tz/api/mnrt/datavalues",
        "apiKey": "mnrt-token-2025-live",
        "apiKeyHeader": "api-key",
        "tlsAllowInsecure": false,
        "enabled": true
      },
      {
        "name": "TANAPA",
        "url": "https://onlinesystems.tanzaniaparks.go.tz:4022/api/nbs_stats",
        "apiKey": "A9F3C1E7B4058D29FA7C3E91D6B24F58C7E3A1D9F042B7C61E9D4A23F56C8B10",
        "apiKeyHeader": "api-key",
        "tlsAllowInsecure": false,
        "enabled": true
      },
      {
        "name": "TAWIRI",
        "url": "https://nwris.tawiri.or.tz/production/research_service/research-summary-api",
        "apiKey": "e7d4940be9daad490f21451e629c1223e5f72b5791609613280bfdeca2bbcc4e",
        "apiKeyHeader": "api-key",
        "tlsAllowInsecure": false,
        "enabled": true
      },
      {
        "name": "TFS",
        "url": "https://fremis.tfs.go.tz/api/nbs-data",
        "apiKey": "HJQXwoERlHRUW6MvkH3SSUNkOjQl5JZkx4uv1mV1iii2l4MfjBM7TAEqJ8Xw",
        "apiKeyHeader": "api-key",
        "tlsAllowInsecure": true,
        "enabled": true
      }
    ]
  }
}
